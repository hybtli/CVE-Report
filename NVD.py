import requests
from bs4 import BeautifulSoup


# Define a function named 'get_info' that takes a CVE ID as input
def get_info(cve_id):
    # Construct the URL for the NVD page of the specified CVE ID
    url = f"https://nvd.nist.gov/vuln/detail/{cve_id}"

    # Send an HTTP GET request to the NVD website and parse the HTML response
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")

    # Extract information from the HTML structure
    # Retrieve the vulnerability summary
    summary_element = soup.find("p", {"data-testid": "vuln-description"})
    summary = summary_element.text if summary_element else "Summary is not available"

    # Retrieve the CVSS (Common Vulnerability Scoring System) base score
    cvss_element = soup.find("a", {"data-testid": "vuln-cvss3-panel-score"})
    cvss_score = cvss_element.text if cvss_element else "Base score is not available"

    # Retrieve the CVSS vector
    vector_element = soup.find("span", {"data-testid": "vuln-cvss3-nist-vector"})
    vector = vector_element.text if vector_element else "Vector is not available"

    # Retrieve a reference link related to the CVE
    reference_element = soup.find("td", {"data-testid": "vuln-hyperlinks-link-0"})
    reference = reference_element.text if reference_element else "Reference is not available"

    # Return the extracted information as a tuple
    return summary, cvss_score, vector, reference
